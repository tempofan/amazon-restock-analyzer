# ğŸ—ï¸ äºšé©¬é€Šè¡¥è´§å·¥å…·æ··åˆæ¶æ„æ“ä½œæ‰‹å†Œ

## ğŸ“‹ æ¦‚è¿°

æœ¬æ‰‹å†Œè¯¦ç»†ä»‹ç»å¦‚ä½•æ“ä½œå’Œç»´æŠ¤äºšé©¬é€Šè¡¥è´§å·¥å…·çš„æ··åˆæ¶æ„æ–¹æ¡ˆã€‚è¯¥æ¶æ„å°†æœ¬åœ°å¼€å‘ç¯å¢ƒä¸äº‘ä»£ç†æœåŠ¡å™¨ç»“åˆï¼Œå®ç°äº†æœ€ä½³çš„å¼€å‘ä½“éªŒå’Œç½‘ç»œè¿é€šæ€§ã€‚

## ğŸ¯ æ¶æ„è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   é£ä¹¦å¹³å°      â”‚â”€â”€â”€â”€â–¶â”‚   æœ¬åœ°é¡¹ç›®       â”‚â”€â”€â”€â”€â–¶â”‚  äº‘ä»£ç†æœåŠ¡å™¨    â”‚â”€â”€â”€â”€â–¶â”‚ é¢†æ˜ŸERP API  â”‚
â”‚ (Webhookè§¦å‘)   â”‚    â”‚ (ä¸šåŠ¡é€»è¾‘å¤„ç†)    â”‚    â”‚ (IPç™½åå•è½¬å‘)   â”‚    â”‚ (æ•°æ®æº)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ” æ ¸å¿ƒä¼˜åŠ¿
- **æœ¬åœ°å¼€å‘**: ä¿æŒå¼€å‘çµæ´»æ€§å’Œè°ƒè¯•ä¾¿åˆ©æ€§
- **äº‘ç«¯ä»£ç†**: è§£å†³IPç™½åå•é™åˆ¶é—®é¢˜
- **èµ„æºä¼˜åŒ–**: äº‘æœåŠ¡å™¨åªéœ€æœ€å°é…ç½®ï¼ˆ~400MBç©ºé—´ï¼‰
- **æˆæœ¬æ§åˆ¶**: æœˆåº¦æˆæœ¬çº¦80-150å…ƒ

## ğŸš€ æ—¥å¸¸æ“ä½œæŒ‡å—

### **1. å¯åŠ¨æ··åˆæ¶æ„ç³»ç»Ÿ** 

#### ç¬¬ä¸€æ­¥ï¼šæ£€æŸ¥ç³»ç»ŸçŠ¶æ€
```bash
# è¿è¡Œæ··åˆæ¶æ„ç®¡ç†å™¨
python scripts/hybrid_architecture_manager.py
```

#### ç¬¬äºŒæ­¥ï¼šæ ¹æ®æŠ¥å‘Šç»“æœé‡‡å–è¡ŒåŠ¨
- **ğŸŸ¢ Excellent**: ç›´æ¥å¼€å§‹ä½¿ç”¨
- **ğŸŸ¡ Good**: å…³æ³¨ä¼˜åŒ–å»ºè®®åä½¿ç”¨  
- **ğŸŸ  Needs Attention**: å¤„ç†é«˜ä¼˜å…ˆçº§é—®é¢˜
- **ğŸ”´ Critical**: ç«‹å³è§£å†³å…³é”®é—®é¢˜

### **2. è¿è¡Œè¡¥è´§åˆ†æä»»åŠ¡**

#### è·å–åº—é“ºåˆ—è¡¨
```bash
python main.py --sellers
```

#### è·å–è¡¥è´§æ•°æ®
```bash
python main.py --restock
```

#### äº¤äº’å¼è¿è¡Œ
```bash
python main.py --interactive
```

#### è‡ªåŠ¨åŒ–è¿è¡Œ
```bash
python main.py --auto
```

### **3. é£ä¹¦æœºå™¨äººæ“ä½œ**

#### å¯åŠ¨é£ä¹¦æœºå™¨äºº
```bash
# Windows
start_feishu_bot.bat

# Linux/macOS  
python feishu/webhook_server.py
```

#### é£ä¹¦å‘½ä»¤
- `æµ‹è¯•` - æµ‹è¯•æœºå™¨äººè¿æ¥
- `åº—é“º` - è·å–åº—é“ºåˆ—è¡¨
- `è¡¥è´§` - è·å–è¡¥è´§å»ºè®®
- `çŠ¶æ€` - æŸ¥çœ‹ç³»ç»ŸçŠ¶æ€

## ğŸ› ï¸ ç»´æŠ¤æ“ä½œ

### **1. äº‘ä»£ç†æœåŠ¡å™¨ç»´æŠ¤**

#### æ£€æŸ¥æœåŠ¡çŠ¶æ€
```bash
# SSHç™»å½•äº‘æœåŠ¡å™¨åæ‰§è¡Œ
sudo systemctl status lingxing-proxy
```

#### æŸ¥çœ‹å®æ—¶æ—¥å¿—
```bash
sudo journalctl -u lingxing-proxy -f
```

#### é‡å¯ä»£ç†æœåŠ¡
```bash
sudo systemctl restart lingxing-proxy
```

#### è¿è¡Œä¼˜åŒ–è„šæœ¬
```bash
cd /opt/lingxing-proxy
chmod +x optimize_cloud_proxy.sh
./optimize_cloud_proxy.sh
```

### **2. æœ¬åœ°é¡¹ç›®ç»´æŠ¤**

#### æ›´æ–°ä¾èµ–åŒ…
```bash
pip install --upgrade -r requirements.txt
```

#### æ¸…ç†æ—¥å¿—æ–‡ä»¶
```bash
# æ¸…ç†7å¤©å‰çš„æ—¥å¿—
find logs/ -name "*.log" -mtime +7 -delete
```

#### å¤‡ä»½é…ç½®
```bash
cp config/server.env config/server.env.backup.$(date +%Y%m%d)
```

### **3. æ€§èƒ½ç›‘æ§**

#### æŸ¥çœ‹ä»£ç†æœåŠ¡å™¨ç»Ÿè®¡
```bash
curl http://175.178.183.96:8080/stats
```

#### ç›‘æ§ç³»ç»Ÿèµ„æº
```bash
# æœ¬åœ°èµ„æºç›‘æ§
python -c "
import psutil
print(f'CPU: {psutil.cpu_percent()}%')
print(f'å†…å­˜: {psutil.virtual_memory().percent}%')
print(f'ç£ç›˜: {psutil.disk_usage(\".\").percent}%')
"
```

## ğŸ”§ æ•…éšœæ’é™¤

### **å¸¸è§é—®é¢˜è§£å†³æ–¹æ¡ˆ**

#### 1. ä»£ç†è¿æ¥å¤±è´¥
```bash
# æ£€æŸ¥ç½‘ç»œè¿é€šæ€§
ping 175.178.183.96

# æ£€æŸ¥ç«¯å£è®¿é—®
telnet 175.178.183.96 8080

# è¿è¡Œè¯Šæ–­å·¥å…·
python test/proxy_connection_diagnostic.py
```

#### 2. Tokenè·å–å¤±è´¥
```bash
# æ¸…é™¤æ—§Token
python -c "
from auth.token_manager import TokenManager
tm = TokenManager()
tm.clear_token()
print('Tokenå·²æ¸…é™¤')
"

# é‡æ–°è·å–
python main.py --test
```

#### 3. APIè°ƒç”¨é”™è¯¯
- **3001002**: IPç™½åå•é—®é¢˜ï¼Œç¡®è®¤äº‘æœåŠ¡å™¨IPå·²æ·»åŠ 
- **2001003**: Tokenè¿‡æœŸï¼Œä¼šè‡ªåŠ¨åˆ·æ–°
- **ç½‘ç»œè¶…æ—¶**: æ£€æŸ¥ä»£ç†æœåŠ¡å™¨çŠ¶æ€

#### 4. é£ä¹¦æœºå™¨äººæ— å“åº”
```bash
# æ£€æŸ¥WebhookæœåŠ¡å™¨
python feishu/test_bot.py

# é‡å¯WebhookæœåŠ¡
python feishu/webhook_server.py
```

## ğŸ“Š ç›‘æ§å’ŒæŠ¥å‘Š

### **è‡ªåŠ¨ç›‘æ§è®¾ç½®**

#### äº‘æœåŠ¡å™¨ç›‘æ§ï¼ˆå·²é€šè¿‡ä¼˜åŒ–è„šæœ¬é…ç½®ï¼‰
- æ¯5åˆ†é’Ÿæ£€æŸ¥æœåŠ¡çŠ¶æ€
- æ¯æ—¥æ”¶é›†æ€§èƒ½ç»Ÿè®¡
- è‡ªåŠ¨æ—¥å¿—è½®è½¬

#### æœ¬åœ°é¡¹ç›®ç›‘æ§
```bash
# æ·»åŠ åˆ°crontab
crontab -e

# æ¯å°æ—¶è¿è¡Œæ¶æ„æ£€æŸ¥
0 * * * * cd /path/to/project && python scripts/hybrid_architecture_manager.py >> logs/hourly_check.log 2>&1
```

### **æ‰‹åŠ¨æŠ¥å‘Šç”Ÿæˆ**
```bash
# ç”Ÿæˆå®Œæ•´çŠ¶æ€æŠ¥å‘Š
python scripts/hybrid_architecture_manager.py

# æŸ¥çœ‹å†å²æŠ¥å‘Š
ls -la logs/hybrid_architecture_report_*.json
```

## ğŸ›ï¸ é…ç½®ç®¡ç†

### **ç¯å¢ƒé…ç½®æ–‡ä»¶**
ä¸»é…ç½®æ–‡ä»¶ï¼š`config/server.env`

#### å…³é”®é…ç½®é¡¹
```env
# APIé…ç½®
LINGXING_APP_ID=your_real_app_id
LINGXING_APP_SECRET=your_real_app_secret

# ä»£ç†é…ç½®
ENABLE_PROXY=True
PROXY_HOST=175.178.183.96
PROXY_PORT=8080
PROXY_PROTOCOL=http
PROXY_TIMEOUT=60

# é£ä¹¦é…ç½®
FEISHU_APP_ID=your_feishu_app_id
FEISHU_APP_SECRET=your_feishu_app_secret
```

### **é…ç½®åˆ‡æ¢**

#### å¯ç”¨/ç¦ç”¨ä»£ç†æ¨¡å¼
```bash
# å¯ç”¨ä»£ç†
sed -i 's/ENABLE_PROXY=False/ENABLE_PROXY=True/' config/server.env

# ç¦ç”¨ä»£ç†
sed -i 's/ENABLE_PROXY=True/ENABLE_PROXY=False/' config/server.env
```

#### æ›´æ¢ä»£ç†æœåŠ¡å™¨
```bash
# ä¿®æ”¹ä»£ç†åœ°å€
sed -i 's/PROXY_HOST=old_ip/PROXY_HOST=new_ip/' config/server.env
```

## ğŸš¨ åº”æ€¥å¤„ç†

### **äº‘ä»£ç†æœåŠ¡å™¨æ•…éšœ**
1. **ç«‹å³åˆ‡æ¢åˆ°ç›´è¿æ¨¡å¼**ï¼š
   ```bash
   sed -i 's/ENABLE_PROXY=True/ENABLE_PROXY=False/' config/server.env
   ```
2. **æ·»åŠ å½“å‰IPåˆ°ç™½åå•**ï¼šç™»å½•é¢†æ˜ŸERPåå°æ·»åŠ æœ¬æœºIP
3. **ä¿®å¤äº‘æœåŠ¡å™¨**ï¼šæŒ‰ç…§ç»´æŠ¤æŒ‡å—ä¿®å¤ä»£ç†æœåŠ¡

### **æœ¬åœ°é¡¹ç›®æ•…éšœ**
1. **é‡å¯è™šæ‹Ÿç¯å¢ƒ**ï¼š
   ```bash
   deactivate
   .venv\Scripts\activate  # Windows
   source .venv/bin/activate  # Linux/macOS
   ```
2. **é‡æ–°å®‰è£…ä¾èµ–**ï¼š
   ```bash
   pip install --force-reinstall -r requirements.txt
   ```
3. **æ¢å¤é…ç½®**ï¼š
   ```bash
   cp config/server.env.backup.* config/server.env
   ```

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–

### **äº‘ä»£ç†æœåŠ¡å™¨ä¼˜åŒ–**
- å·²é€šè¿‡ `optimize_cloud_proxy.sh` è„šæœ¬å®ç°
- åŒ…å«ç›‘æ§ã€ç»Ÿè®¡ã€å¤‡ä»½ã€ç³»ç»Ÿè°ƒä¼˜

### **æœ¬åœ°é¡¹ç›®ä¼˜åŒ–**
```bash
# æ¸…ç†ç¼“å­˜
find . -name "__pycache__" -type d -exec rm -rf {} +
find . -name "*.pyc" -delete

# ä¼˜åŒ–ä¾èµ–
pip install pipreqs
pipreqs . --force
```

### **ç½‘ç»œä¼˜åŒ–**
- ä½¿ç”¨ä»£ç†è¿æ¥æ± 
- é…ç½®åˆé€‚çš„è¶…æ—¶æ—¶é—´
- å¯ç”¨è¯·æ±‚é‡è¯•æœºåˆ¶

## ğŸ”„ å‡çº§å’Œæ›´æ–°

### **ä»£ç æ›´æ–°**
```bash
git pull origin main
pip install --upgrade -r requirements.txt
python scripts/hybrid_architecture_manager.py
```

### **äº‘ä»£ç†æœåŠ¡å™¨æ›´æ–°**
```bash
# åœ¨äº‘æœåŠ¡å™¨ä¸Šæ‰§è¡Œ
cd /opt/lingxing-proxy
./backup_config.sh  # å…ˆå¤‡ä»½
# ä¸Šä¼ æ–°ç‰ˆæœ¬æ–‡ä»¶
sudo systemctl restart lingxing-proxy
```

## ğŸ“ æŠ€æœ¯æ”¯æŒ

### **é—®é¢˜è¯Šæ–­æµç¨‹**
1. è¿è¡Œ `python scripts/hybrid_architecture_manager.py`
2. æŸ¥çœ‹ç”Ÿæˆçš„è¯Šæ–­æŠ¥å‘Š
3. æŒ‰ç…§å»ºè®®æ‰§è¡Œä¿®å¤æ“ä½œ
4. å¦‚é—®é¢˜æŒç»­ï¼ŒæŸ¥çœ‹è¯¦ç»†æ—¥å¿—

### **æ—¥å¿—æ–‡ä»¶ä½ç½®**
- æœ¬åœ°é¡¹ç›®æ—¥å¿—ï¼š`logs/lingxing_api.log`
- äº‘ä»£ç†æœåŠ¡å™¨æ—¥å¿—ï¼š`/opt/lingxing-proxy/proxy_server.log`
- ç³»ç»ŸæœåŠ¡æ—¥å¿—ï¼š`sudo journalctl -u lingxing-proxy`

### **è”ç³»æ–¹å¼**
- æŸ¥çœ‹é¡¹ç›®READMEæ–‡æ¡£
- æ£€æŸ¥GitHub Issues
- å‚è€ƒAPIæ–‡æ¡£ï¼š`api_doc/` ç›®å½•

---

**ğŸ‰ é€šè¿‡è¿™ä¸ªæ··åˆæ¶æ„æ–¹æ¡ˆï¼Œä½ å¯ä»¥äº«å—æœ¬åœ°å¼€å‘çš„ä¾¿åˆ©æ€§ï¼ŒåŒæ—¶è§£å†³ç½‘ç»œé™åˆ¶é—®é¢˜ï¼Œå®ç°ç¨³å®šå¯é çš„è¡¥è´§æ•°æ®è·å–æœåŠ¡ï¼** 